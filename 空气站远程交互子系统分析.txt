环境空气质量在线监测平台
空气质量在线监测平台，采用多层次的系统设计方法，可以对接不同性质（国控，省空，区域等），不同厂家的空气质量子站相关数据，建立一套完善的空气质量监测、预警、发布的可视化平台。同时用数据质控，远程反控、统计分析等信息化手段，帮助环境监测部门及时、全面、准确地掌握本辖区的空气质量现状，实现对本辖区监测站点空气质量进行准确分析，为空气质量的溯源提供决策平台。建立统一的公众发布信息平台，提供以互联网，手机APP，微信等多种多样的发布形式和发布渠道。


<------------------------
系统简介：


环境空气质量在线监测平台，是一套完善的空气质量监测、预警的可视化平台，可以对接不同性质（国控，省控等）、不同厂家的空气质量子站。同时用数据质控，远程反控、统计分析等信息化手段，帮助环境监测部门及时、全面、准确地掌握本辖区的空气质量现状，实现对本辖区监测站点空气质量的准确分析，为空气质量的溯源提供决策依据。



项目简介：

环境空气质量在线监测平台，是为了对某辖区站点的空气质量准确分析而开发的一套完善的可在线实时监测空气质量、预警、远程反控、统计分析的可视化平台。系统分为三个子系统：远程交互子系统、数据存储子系统、web在线监测应用系统。

远程交互系统主要实现与现场端的数据交互；数据存储系统实现对接收到的有效数据进行存储与访问；应用系统提供业务相关的功能的实现与接口。

-------------------->



<------------------------
系统详细介绍：


现场端与远程交互子系统建立连接，传输数据，数据库存储子系统对数据解析处理存储数据库，web应用系统从数据库查询数据进行统计分析，以图表等形式显示数据。并且系统提供反控接口，用户可在浏览器上操作实现对现场端站点的控制及配置，而这个过程是web服务器将用户反控命令发送给远程交互系统，由远程交互子系统与现场端交互，完成反控，并将结果返回给web端。

（数据存储系统：设计表并提供对表操作的各种功能接口）

（远程交互系统：与web应用系统连接，接收反控命令，与现场端连接并交互，将监测数据存储数据库，并将命令执行结果反馈给web应用系统。



其实就是个通信服务器：与现场端交互，等待现场端建立连接，注册、发送监测数据，把数据存数据库；服务器也会下发控制命令给现场端，现场端执行命令返回执行结果。
服务器下发的命令来自web应用系统，并将执行结果返回给应用系统。



1.处理现场端的连接，
2.处理连接后的交互，将此处设计成代理模块，一个现场端连接后，由一个代理负责后续所有通信过程。
由于212协议的命令繁多且主动发起者可能是服务器也可能是现场端，而每个命令都是过程性的，在一个命令还未完成时其他命令可能已经下发了，需要同时处理多条命令，为避免判断此时接收的数据具体是哪条命名的响应的复杂处理，
所以此处发送与接收设计成了异步处理模式：由数据接收中心和processor组成观察者模式，
数据接收中心负责从socket读取数据，简单处理（去除非法数据，并校验）成212数据包，
processor用来实现每个命令的执行流程及每个阶段具体的处理过程，提供具体的发送请求接口与处理接口，并用状态字确定命令完成到哪个阶段；
数据中心接收到数据后通知processor，每个processor根据命令标识和状态字确定是否是自己需要的应答从而决定是否处理。 在其中还涉及 现场端注册、网络中断、超时重发、心跳机制等等。

对于现场端发起的命令，服务器时刻等待着接收和处理，，对于服务器下发的命令，每下发一个其实就是生成一个该命令的processor，等待着与现场端的继续交互。
而服务器下发的命令都是来自web端，此处，服务器与web端又要建立连接，等待web端下发命令，并在与现场端交互完成该命令后将执行结果返回给web端。）


（在线监控应用系统：一般的B/S系统，对监测站传来的数据进行 实时显示、图表查询、统计分析、生成报表等等）

------------------------->

<---------
更详细的介绍：
多线程实现数据接收，阻塞缓冲队列设计

注册、网络中断、超时重发、心跳机制

对外功能接口具体实现，接收reqlist

proxy管理map 实现web与现场端多对多



--------->




相关知识：


212协议是什么？
212协议是环保局发布的污染源在线自动监控(监测)系统数据传输标准。不仅规定了在线监控（监测）仪器仪表和数据采集传输仪之间的数据传输格式（通讯协议数据结构），同时给出了代码定义
还规定了传输的过程及参数命令、交互命令、数据命令和控制命令的格式
完整的命令由请求方发起、响应方应答组成
通讯流程：对每一类命令规定了通讯流程  通讯（包括发起、数据交换、应答等）



远程交互子系统完成与现场站点设备的连接，获取设备数据存入数据库，WEB在线监测应用程序 通过调用数据库访问接口对数据进行统计分析显示，

反控功能：可以在浏览器上对站点进行配置，

实现212协议的解析与封装


远程交互子系统实现内容：

1.与下位机可进行socket连接，收发212数据，并根据212协议进行解析处理

2.与web端通信，实现反控功能






